---
phase: 06-package-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [package.json, .gitignore, .github/workflows/ci.yml, .github/workflows/release.yml]
autonomous: true
---

<objective>
Configure npm package and GitHub Actions for publication.

Purpose: Enable npm distribution with automated CI/CD
Output: package.json, .gitignore, CI workflow, release workflow
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/STATE.md

Reference patterns from: ../business-design-mcp/package.json, ../business-design-mcp/.github/workflows/
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create package.json</name>
  <files>package.json</files>
  <action>
Create package.json at project root:

```json
{
  "name": "@anthropic/business-design",
  "version": "1.0.0",
  "description": "Markdown-based slash commands for business framework design",
  "type": "module",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/anthropics/business-design.git"
  },
  "homepage": "https://github.com/anthropics/business-design#readme",
  "bugs": {
    "url": "https://github.com/anthropics/business-design/issues"
  },
  "files": [
    "commands",
    "lib",
    "README.md",
    "LICENSE"
  ],
  "keywords": [
    "claude-code",
    "slash-commands",
    "business-model-canvas",
    "lean-canvas",
    "value-proposition-canvas",
    "swot",
    "persona",
    "competitive-analysis",
    "market-sizing"
  ],
  "author": "",
  "license": "MIT",
  "engines": {
    "node": ">=18"
  }
}
```

Note: Package name TBD - using placeholder. No build scripts needed (markdown-only).
  </action>
  <verify>cat package.json</verify>
  <done>package.json exists with correct structure</done>
</task>

<task type="auto">
  <name>Task 2: Create .gitignore</name>
  <files>.gitignore</files>
  <action>
Create .gitignore:

```
node_modules/
.DS_Store
*.log
```

Minimal - no build artifacts since this is markdown-only.
  </action>
  <verify>cat .gitignore</verify>
  <done>.gitignore exists</done>
</task>

<task type="auto">
  <name>Task 3: Create CI workflow</name>
  <files>.github/workflows/ci.yml</files>
  <action>
Create .github/workflows/ci.yml:

```yaml
name: CI

on:
  pull_request:
    branches: [main]

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Validate package.json
        run: node -e "require('./package.json')"

      - name: Check required files exist
        run: |
          test -f README.md
          test -f LICENSE
          test -d commands
          test -d lib
```

Simple validation - no build/test needed for markdown package.
  </action>
  <verify>cat .github/workflows/ci.yml</verify>
  <done>CI workflow exists</done>
</task>

<task type="auto">
  <name>Task 4: Create release workflow</name>
  <files>.github/workflows/release.yml</files>
  <action>
Create .github/workflows/release.yml based on business-design-mcp pattern:

```yaml
name: Release

on:
  push:
    branches: [main]

jobs:
  release:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      id-token: write
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Get current version
        id: current
        run: echo "version=$(node -p "require('./package.json').version")" >> $GITHUB_OUTPUT

      - name: Check if version already released
        id: check
        run: |
          if git rev-parse "v${{ steps.current.outputs.version }}" >/dev/null 2>&1; then
            echo "needs_bump=true" >> $GITHUB_OUTPUT
          else
            echo "needs_bump=false" >> $GITHUB_OUTPUT
          fi

      - uses: actions/setup-node@v4
        with:
          node-version: '22'
          registry-url: 'https://registry.npmjs.org'

      - name: Upgrade npm for trusted publishing
        run: npm install -g npm@latest

      - name: Bump patch version
        if: steps.check.outputs.needs_bump == 'true'
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          npm version patch --no-git-tag-version
          git add package.json
          git commit -m "chore: bump version to $(node -p "require('./package.json').version")"
          git push

      - name: Get release version
        id: version
        run: echo "version=$(node -p "require('./package.json').version")" >> $GITHUB_OUTPUT

      - name: Validate package
        run: |
          test -f README.md
          test -f LICENSE
          test -d commands
          test -d lib

      - name: Create tag
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          git tag -a "v${{ steps.version.outputs.version }}" -m "Release v${{ steps.version.outputs.version }}"
          git push origin "v${{ steps.version.outputs.version }}"

      - name: Publish to npm
        run: npm publish --provenance --access public
        env:
          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}

      - name: Create GitHub Release
        uses: softprops/action-gh-release@v2
        with:
          tag_name: v${{ steps.version.outputs.version }}
          generate_release_notes: true
```

Auto version bump, tagging, npm publish with provenance, GitHub release.
  </action>
  <verify>cat .github/workflows/release.yml</verify>
  <done>Release workflow exists with npm publish</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] package.json exists with correct metadata
- [ ] .gitignore exists
- [ ] .github/workflows/ci.yml exists
- [ ] .github/workflows/release.yml exists
- [ ] All YAML files are valid syntax
</verification>

<success_criteria>
- All tasks completed
- Package ready for npm publication
- CI/CD workflows configured
</success_criteria>

<output>
After completion, create `.planning/phases/06-package-setup/06-01-SUMMARY.md`
</output>
